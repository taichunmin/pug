<!doctype html><html><head><meta charset="UTF-8"><meta content="IE=edge" http-equiv="X-UA-Compatible"><meta content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,viewport-fit=cover,user-scalable=no" name="viewport"><title>微程式刷卡通知</title><script src="https://www.googletagmanager.com/gtag/js?id=UA-39556213-3" async></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-39556213-3");</script><link href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css" rel="stylesheet"><link href="https://cdn.jsdelivr.net/npm/font-awesome@4/css/font-awesome.min.css" rel="stylesheet"><link href="https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.min.css" rel="stylesheet"><link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700&display=swap" rel="stylesheet"><meta content="2133031763635285" property="fb:app_id"><meta content="若有任何使用上的問題，請與創新前瞻計畫室聯繫。" property="og:description"><meta content="512" property="og:image:height"><meta content="512" property="og:image:width"><meta content="https://i.imgur.com/7F25dCI.png" property="og:image"><meta content="zh_TW" property="og:locale"><meta content="筆記國度" property="og:site_name"><meta content="微程式刷卡通知" property="og:title"><meta content="website" property="og:type"><meta content="https://lihi1.com/qYLWs" property="og:url"><style>[v-cloak]{display:none}.h1,.h2,.h3,.h4,.h5,.h6,body,h1,h2,h3,h4,h5,h6{font-family:"Noto Sans TC",sans-serif}body{background-image:url(https://i.imgur.com/nFMLMdG.png);background-repeat:no-repeat;background-position:top;background-size:auto 480px}</style></head><body><div class="container my-3" id="app" v-cloak><h2 class="text-danger mb-3 text-center">微程式刷卡通知</h2><img class="d-block mx-auto w-100" src="https://i.imgur.com/7xIMgXO.png" style="max-width:580px"><div class="text-monospace"><div class="form-group" :class="{'was-validated': !!h.uid}"><label for="h-uid">員工編號</label><input class="form-control" id="h-uid" required type="tel" v-model="h.uid" inputmode="tel" pattern="[0-9-]{5,}" placeholder="請輸入您的微程式員工編號"></div><ul class="text-danger" style="padding-inline-start:1.25rem"><li>實際出缺勤紀錄請以 Portal 系統為主。</li><li>關於本刷卡通知服務若有申請、使用或解除連動之各項問題，請洽詢創新前瞻計畫室同仁。</li></ul><div class="form-group form-check"><input class="form-check-input" id="h-gdpr" required type="checkbox" v-model="gdpr"><label for="h-gdpr" class="form-check-label">我同意「微程式刷卡通知」服務依<a href="https://docs.google.com/presentation/d/1jk2sJg2Xy8YhQLbVAerJtSAmwKaHEReOEOFxBymHEGk/edit?usp=sharing&openExternalBrowser=1" target="_blank">「個資使用條款聲明」</a>蒐集、處理及利用我的個人資料。</label></div><div class="d-flex"><a href="https://docs.google.com/presentation/d/1jk2sJg2Xy8YhQLbVAerJtSAmwKaHEReOEOFxBymHEGk/edit?usp=sharing&openExternalBrowser=1" class="btn align-items-center d-flex flex-fill justify-content-center btn-dark mr-2" target="_blank"><span class="mr-2 fa fa-question-circle"></span> 使用說明</a><button @click="btnGoogleSignin" class="btn align-items-center d-flex flex-fill justify-content-center btn-danger" type="button"><span class="mr-2 fa fa-google"></span><span>確認送出<br>進行認證</span></button></div><a href="https://notify-bot.line.me/my/" class="btn btn-block btn-link btn-sm mt-3">如果想要取消刷卡通知請點此</a></div></div><script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/dayjs@1/dayjs.min.js" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/json5@2/dist/index.min.js" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/lodash@4/lodash.min.js" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/papaparse@5/papaparse.min.js" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/popper.js@1/dist/umd/popper.min.js" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1/components/prism-core.min.js" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1/plugins/autoloader/prism-autoloader.min.js" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/qs@6/dist/qs.min.js" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/sweetalert2@11" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/vue@2/dist/vue.min.js" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.min.js" crossorigin="anonymous"></script><script>window.vm=new Vue({el:"#app",data:{gdpr:!1,h:{uid:""}},async mounted(){try{var t=JSON5.parse(localStorage.getItem(location.pathname));t&&this.$set(this,"h",{...this.h,...t})}catch(t){}this.$watch("h",()=>{localStorage.setItem(location.pathname,JSON5.stringify(this.h))},{deep:!0}),await this.init()},methods:{async init(){try{var t=_.fromPairs(_.filter([["icon",this.param("swalicon")],["title",this.param("swaltitle")],["text",this.param("swaltext")]],t=>_.isString(t[1])));t.text&&await Swal.fire(t)}catch(t){console.err(t),await Swal.fire({icon:"error",title:"初始化錯誤",text:t.message})}},async btnGoogleSignin(){try{if(this.showLoading("請稍候","驗證中"),!this.gdpr)return await Swal.fire({icon:"error",title:"無法提供刷卡通知",text:"由於您不同意本服務取用您的資料，故無法為您提供服務。"});if(!this.h.uid)throw new Error("員工編號是必填欄位");const t=new URL("https://us-central1-mp-parking-lot.cloudfunctions.net/gcf-doorkeeper-line-http/googleopenid");return t.searchParams.set("uid",this.h.uid),t.searchParams.set("t",Date.now()),location.href=t.href,await new Promise(t=>{})}catch(t){console.error(t),await Swal.fire({icon:"error",title:"驗證失敗",text:t.message})}},showLoading(t,e){Swal.fire({title:t,text:e,allowOutsideClick:!1,showConfirmButton:!1,willOpen:()=>{Swal.showLoading()}})},param(t,e){t=new URL(location).searchParams.get(t);return _.isNil(t)?e:t}}});</script></body></html>