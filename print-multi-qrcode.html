<!doctype html><html><head><meta charset="UTF-8"><meta content="IE=edge" http-equiv="X-UA-Compatible"><meta content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,viewport-fit=cover,user-scalable=no" name="viewport"><title>在紙上一次印多個 QRCode</title><script src="https://www.googletagmanager.com/gtag/js?id=UA-39556213-3" async></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-39556213-3");</script><link href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css" rel="stylesheet"><link href="https://cdn.jsdelivr.net/npm/font-awesome@4/css/font-awesome.min.css" rel="stylesheet"><link href="https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.min.css" rel="stylesheet"><link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700&display=swap" rel="stylesheet"><meta content="zh_TW" property="og:locale"><meta content="筆記國度" property="og:site_name"><meta content="在紙上一次印多個 QRCode" property="og:title"><meta content="website" property="og:type"><meta content="https://taichunmin.idv.tw/pug/print-multi-qrcode.html" property="og:url"><style>[v-cloak]{display:none}.h1,.h2,.h3,.h4,.h5,.h6,body,h1,h2,h3,h4,h5,h6{font-family:"Noto Sans TC",sans-serif}.qrcode-title{letter-spacing:-1px;line-height:1.1;font-size:.875rem}@media print{.pagebreak{page-break-before:always}}</style></head><body><div class="container text-monospace" id="app" v-cloak><div class="card d-print-none my-3"><div class="card-header">在紙上一次印多個 QRCode</div><div class="card-body"><div class="from-group"><label>QRCode 資料</label><textarea class="form-control form-control-sm" rows="15" style="font-size:.75rem" v-model="rawdata"></textarea><small class="text-muted">請直接從 Excel 複製貼上，每行 1 筆資料，第 1 欄請填 QRCode 內容，剩下的欄位都是標題文字。</small></div><div class="form-inline mt-2"><button @click="btnPrint" class="btn btn-primary" type="button">列印</button><select class="form-control ml-2" v-model.number="h.rows"><option :value="rows" v-for="rows of 9">每頁 {{ rows }} 排</option></select><select class="form-control ml-2" v-model.number="h.cols"><option :value="cols" v-for="cols of 9">每排 {{ cols }} 個</option></select></div></div></div><table class="d-none d-print-table mb-0 pagebreak table table-bordered" v-for="pages of _.chunk(qrcodes, h.rows * h.cols)"><tr v-for="cols of _.chunk(pages, h.cols)"><td :style="{width: `${100 / h.cols}%`}" class="pb-3 pt-4 px-4" v-for="qrcode of cols"><div class="align-items-center d-flex flex-column"><div class="mb-2 w-100" v-html="qrcode.svg"></div><div class="qrcode-title" v-for="title of qrcode.titles">{{ title }}</div></div></td></tr></table></div><script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/dayjs@1/dayjs.min.js" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/json5@2/dist/index.min.js" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/lodash@4/lodash.min.js" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/papaparse@5/papaparse.min.js" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/popper.js@1/dist/umd/popper.min.js" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1/components/prism-core.min.js" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1/plugins/autoloader/prism-autoloader.min.js" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/qs@6/dist/qs.min.js" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/sweetalert2@11" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/vue@2/dist/vue.min.js" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.min.js" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/qrcode@1/build/qrcode.min.js" crossorigin="anonymous"></script><script>window.sleep=e=>new Promise(t=>setTimeout(t,e)),window.vm=new Vue({el:"#app",data:{qrcodes:[],rawdata:"",h:{cols:4,rows:5}},async mounted(){try{var t=JSON5.parse(localStorage.getItem(location.pathname));t&&this.$set(this,"h",{...this.h,...t})}catch(t){}this.$watch("h",()=>{localStorage.setItem(location.pathname,JSON5.stringify(this.h))},{deep:!0})},methods:{async btnPrint(){this.showLoading("請稍候","正在產生 QRCode");const t=_.compact(await Promise.all(_.map(this.parseTsv(this.rawdata),async t=>{try{var[e,...s]=_.map(t,_.trim);if(e)return{qrcode:e,svg:await this.textToQrSvg(e),titles:s};throw new Error("qrcode is required")}catch(t){return null}})));var e=this.h.cols*this.h.rows,e=e-1-(t.length-1)%e;if(e){const s=_.first(t)?.titles?.length??1;t.push(..._.times(e,()=>({svg:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1 1" />',titles:_.times(s,()=>" ")})))}this.$set(this,"qrcodes",t),await Swal.fire({icon:"success",title:"產生成功",text:`共 ${t.length-e} 筆資料`}),await window.sleep(1e3),window.print()},showLoading(t,e){Swal.fire({title:t,text:e,allowOutsideClick:!1,showConfirmButton:!1,willOpen:()=>{Swal.showLoading()}})},textToQrSvg:(()=>{const e={margin:0};return async t=>_.trim(await QRCode.toString(t,e))})(),parseTsv(t){return _.get(Papa.parse(_.trim(t),{delimiter:"\t",encoding:"utf8"}),"data",[])}}});</script></body></html>