<!doctype html><html><head><meta charset="UTF-8"><meta content="IE=edge" http-equiv="X-UA-Compatible"><meta content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,viewport-fit=cover,user-scalable=no" name="viewport"><title>瘋狂詭宅第二版 代碼謎題</title><script src="https://www.googletagmanager.com/gtag/js?id=UA-39556213-3" async></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-39556213-3");</script><link href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css" rel="stylesheet"><link href="https://cdn.jsdelivr.net/npm/font-awesome@4/css/font-awesome.min.css" rel="stylesheet"><link href="https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.min.css" rel="stylesheet"><link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700&display=swap" rel="stylesheet"><style>[v-cloak]{display:none}.h1,.h2,.h3,.h4,.h5,.h6,body,h1,h2,h3,h4,h5,h6{font-family:"Noto Sans TC",sans-serif}</style></head><body><div class="container" id="app" v-cloak><h3 class="text-center my-3">瘋狂詭宅第二版 代碼謎題</h3><div class="row"><div class="col-sm"><div class="card mb-3"><h5 class="card-header"><i class="fa fa-fw fa-gamepad"></i> 代碼謎題</h5><div class="card-body"><div class="form-group"><label for="i-num">有幾個數字、幾個格子？</label><div class="dropdown"><button class="btn dropdown-toggle btn-block btn-primary" type="button" data-toggle="dropdown"><span class="fa fa-fw fa-key"></span> {{ i.num }} 種數字 {{ i.slot }} 個格子 </button><div class="dropdown-menu"><template v-for="n in [3,4,5,6]"><button class="dropdown-item" type="button" @click="(n !== i.num || s !== i.slot) && btnSetNumSlot(n, s)" :class="{active: (n === i.num && s === i.slot)}" v-for="s in [3,4,5,6]">{{ n }} 種數字 {{ s }} 個格子</button></template></div></div></div><div class="form-group"><label for="i-guess">請輸入 {{ i.slot }} 位數 1 到 {{ i.num }} 的數字 (可重複)</label><div class="input-group input-group-sm mb-2" :class="getGuessClass(i.guess)"><div class="input-group-prepend"><span class="input-group-text">{{ i.guesses.length + 1 }}</span></div><input :class="getGuessClass(i.guess)" :maxlength="i.slot" class="form-control" inputmode="numeric" v-model="i.guess" @keyup.enter="btnPushGuess" id="i-guess"><div class="input-group-append"><button class="btn btn-success" type="button" @click="btnPushGuess">送出</button></div></div></div><table class="mb-0 table table-bordered table-sm text-center" v-if="i.guesses.length"><thead><tr><th>#</th><th>猜測數字</th><th colspan="2">結果</th></tr></thead><tbody class="text-monospace"><tr v-for="(guess, guessId) in i.guesses"><template v-for="simi in [calcSimilarity(guess, i.answer)]"><th>{{ guessId + 1 }}</th><td>{{ guess }}</td><td>{{ similarityToStr[simi] }}</td><td><a @click="btnPushSolver(guess, simi)" class="badge badge-info mr-1" href="#">求解</a></td></template></tr></tbody></table></div><div class="card-footer text-right"><button class="btn btn-danger btn-sm" type="button" @click="btnNewGame(false)"><span class="fa fa-fw fa-trash-o"></span> 開新遊戲</button></div></div></div><div class="col-sm"><div class="card mb-3"><h5 class="card-header"><i class="fa fa-fw fa-graduation-cap"></i> 代碼謎題求解程式</h5><div class="card-body"><div class="form-group"><label>請輸入猜測數字與結果</label><div class="input-group input-group-sm mb-2" :class="getGuessClass(solver.guess)" v-for="(solver, solverId) in i.solvers"><div class="input-group-prepend"><span class="input-group-text">{{ solverId + 1 }}</span></div><input :class="getGuessClass(solver.guess)" :maxlength="i.slot" class="form-control" inputmode="numeric" v-model="solver.guess"><div class="input-group-append"><button class="btn dropdown-toggle btn-outline-secondary" type="button" data-toggle="dropdown">{{ similarityToStr[solver.simi] }}</button><div class="dropdown-menu dropdown-menu-right"><button class="dropdown-item" type="button" @click="solver.simi = simi" :class="{active: simi === solver.simi}" v-for="simi in similarity">{{ similarityToStr[simi] }}</button></div></div></div></div><div class="form-group mb-0"><label>可能的謎底 <span class="badge badge-pill badge-success">{{ possibilities.length }}</span></label><small class="form-text text-muted" v-if="!possibilities.length">請輸入猜測數字與結果來顯示可能的謎底</small><small class="form-text text-muted" v-if="possibilities.length > 100">僅顯示前 100 筆可能的謎底</small><div id="possibilities"><a @click="i.guess = possible" class="badge badge-info mr-1" href="#" v-for="possible in _.take(possibilities, 100)">{{ possible }}</a></div></div></div><div class="card-footer text-right"><button class="btn btn-danger btn-sm" type="button" @click="btnNewSolver(false)"><span class="fa fa-fw fa-trash-o"></span> 重新求解</button></div></div></div></div></div><script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/dayjs@1/dayjs.min.js" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/json5@2/dist/index.min.js" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/lodash@4/lodash.min.js" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/papaparse@5/papaparse.min.js" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/popper.js@1/dist/umd/popper.min.js" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1/components/prism-core.min.js" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1/plugins/autoloader/prism-autoloader.min.js" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/qs@6/dist/qs.min.js" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/sweetalert2@11" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/vue@2/dist/vue.min.js" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.min.js" crossorigin="anonymous"></script><script>const SIMILARITY={2:[0,1,2,10,20],3:[0,1,2,3,10,11,12,20,30],4:[0,1,2,3,4,10,11,12,13,20,21,22,30,40],5:[0,1,2,3,4,5,10,11,12,13,14,20,21,22,23,30,31,32,40,50],6:[0,1,2,3,4,5,6,10,11,12,13,14,15,20,21,22,23,24,30,31,32,33,40,41,42,50,60]};window.vm=new Vue({el:"#app",data:{i:{answer:"",guess:"",guesses:[],num:3,slot:3,solvers:[]},similarityToStr:{0:"0A0B",1:"0A1B",2:"0A2B",3:"0A3B",4:"0A4B",5:"0A5B",6:"0A6B",10:"1A0B",11:"1A1B",12:"1A2B",13:"1A3B",14:"1A4B",15:"1A5B",20:"2A0B",21:"2A1B",22:"2A2B",23:"2A3B",24:"2A4B",30:"3A0B",31:"3A1B",32:"3A2B",33:"3A3B",40:"4A0B",41:"4A1B",42:"4A2B",50:"5A0B",60:"6A0B"}},mounted(){try{var s=JSON5.parse(localStorage.getItem(location.pathname));s&&this.$set(this,"i",{...this.i,...s})}catch(s){}this.$watch("i",()=>{localStorage.setItem(location.pathname,JSON5.stringify(this.i))},{deep:!0}),this.verifyGuess(this.i.answer)||this.btnNewGame(!0),this.i.solvers.length||this.btnNewSolver(!0)},computed:{digits(){return"123456".slice(0,this.i.num)},similarity(){return SIMILARITY[this.i.slot]},possibilities(){const n=_.filter(this.i.solvers,s=>this.verifyGuess(s.guess)&&_.hasIn(this.similarityToStr,s.simi));if(!n.length)return[];const r=[],h=(t="",e=0)=>{if(e<this.i.slot)return _.each(this.digits,(s,i)=>h(t+s,e+1));let s=!0;for(const i of n)if(this.calcSimilarity(t,i.guess)!==i.simi){s=!1;break}s&&r.push(t)};return h(),r}},methods:{verifyGuess(i){if(!_.isString(i)||i.length!==this.i.slot)return!1;for(let s=0;s<i.length;s++)if(!_.inRange(i[s],1,this.i.num+1))return!1;return!0},getGuessClass(s){return _.isString(s)&&s.length?this.verifyGuess(s)?"is-valid":"is-invalid":""},calcSimilarity(i,t){let e=0;const n=_.times(6,()=>[0,0]);for(let s=0;s<i.length;s++)i[s]===t[s]&&e++,n[i[s]-1][0]++,n[t[s]-1][1]++;return _.sumBy(n,s=>_.min(s))+9*e},btnPushGuess(){var s=this.i.guess;this.verifyGuess(s)&&!_.includes(this.i.guesses,s)&&(this.i.guesses.push(s),this.i.guess="")},async btnSetNumSlot(s,i,t=!1){(t||await this.confirm(`將代碼謎題調整為「${s} 種數字 ${i} 個格子」嗎？`))&&(this.i.num=s,this.i.slot=i,this.btnNewGame(!0),this.btnNewSolver(!0))},async btnNewGame(s=!1){(s||await this.confirm("是否開始新的代碼謎題？"))&&(this.i.answer=_.times(this.i.slot,()=>_.sample(this.digits)).join(""),this.i.guess="",this.i.guesses=[])},async btnNewSolver(s=!1){(s||await this.confirm("是否清空求解資料？"))&&this.$set(this.i,"solvers",_.times(9,s=>({guess:"",simi:0})))},async btnPushSolver(s,i){const t=_.find(this.i.solvers,s=>!this.verifyGuess(s.guess));t&&(t.guess=s,t.simi=i)},async confirm(s,i="是",t="否"){return!!(await Swal.fire({cancelButtonColor:"#3085d6",cancelButtonText:t,confirmButtonColor:"#d33",confirmButtonText:i,icon:"question",showCancelButton:!0,text:s})).value}}});</script></body></html>