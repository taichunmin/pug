<!doctype html><html><head><meta charset="UTF-8"><meta content="IE=edge" http-equiv="X-UA-Compatible"><meta content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,viewport-fit=cover,user-scalable=no" name="viewport"><title>夢森林課程報名</title><script src="https://www.googletagmanager.com/gtag/js?id=UA-39556213-3" async></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-39556213-3");</script><link href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css" rel="stylesheet"><link href="https://cdn.jsdelivr.net/npm/font-awesome@4/css/font-awesome.min.css" rel="stylesheet"><link href="https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.min.css" rel="stylesheet"><link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700&display=swap" rel="stylesheet"><meta content="2133031763635285" property="fb:app_id"><meta content="夢森林課程報名" property="og:description"><meta content="zh_TW" property="og:locale"><meta content="筆記國度" property="og:site_name"><meta content="夢森林課程報名" property="og:title"><meta content="website" property="og:type"><meta content="https://liff.line.me/1655633310-kWv3DWxn" property="og:url"><style>[v-cloak]{display:none}.h1,.h2,.h3,.h4,.h5,.h6,body,h1,h2,h3,h4,h5,h6{font-family:"Noto Sans TC",sans-serif}</style></head><body><div class="container-fluid my-3" id="app" v-cloak v-if="ready"><h3 class="mb-3 text-center">夢森林課程報名</h3><div class="text-monospace was-validated"><div class="input-group input-group-sm mb-2"><div class="input-group-prepend"><span class="input-group-text justify-content-end">時間</span></div><input class="form-control" :value="time" disabled readonly></div><div class="input-group input-group-sm mb-2"><div class="input-group-prepend"><span class="input-group-text justify-content-end">課名</span></div><textarea class="form-control" rows="3" :value="course" disabled readonly></textarea></div><div class="input-group input-group-sm mb-2"><div class="input-group-prepend"><span class="input-group-text justify-content-end">姓名</span></div><input class="form-control" pattern=".{2,}" required v-model="h.name"></div><div class="input-group input-group-sm mb-2"><div class="input-group-prepend"><span class="input-group-text justify-content-end">信箱</span></div><input class="form-control" pattern="[\w.]+@program.com.tw" required v-model="h.email" inputmode="email" type="email"></div><div class="input-group input-group-sm mb-2"><div class="input-group-prepend"><span class="input-group-text justify-content-end">部門</span></div><input class="form-control" pattern=".{2,}" required v-model="h.department"></div><div class="input-group input-group-sm mb-2"><div class="input-group-prepend"><span class="input-group-text justify-content-end">職稱</span></div><input class="form-control" pattern=".{2,}" required v-model="h.title"></div><div class="input-group input-group-sm mb-2"><div class="input-group-prepend"><span class="input-group-text justify-content-end">備註</span></div><textarea class="form-control" rows="5" v-model="note"></textarea></div><button @click="btnSubmit" class="btn btn-block btn-lg btn-success" type="button">送出</button></div></div><script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/dayjs@1/dayjs.min.js" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/json5@2/dist/index.min.js" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/lodash@4/lodash.min.js" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/papaparse@5/papaparse.min.js" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/popper.js@1/dist/umd/popper.min.js" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1/components/prism-core.min.js" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1/plugins/autoloader/prism-autoloader.min.js" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/qs@6/dist/qs.min.js" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/sweetalert2@11" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/vue@2/dist/vue.min.js" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.min.js" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/joi@17/dist/joi-browser.min.js" crossorigin="anonymous"></script><script src="https://static.line-scdn.net/liff/edge/2/sdk.js" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/crypto-js@4/crypto-js.min.js" crossorigin="anonymous"></script><script>const loginPromise=(async()=>{if(await liff.init({liffId:"1655633310-kWv3DWxn"}),!liff.isLoggedIn())return liff.login({redirectUri:location.href}),new Promise(t=>{});var t=await liff.getProfile().catch(()=>({}));if(t.userId)return window.gtagSetLineId&&window.gtagSetLineId(t.userId),t;throw new Error("無法取得 userId")})();window.decodeBase64=t=>CryptoJS.enc.Utf8.stringify(CryptoJS.enc.Base64.parse(t.replace(/[-_]/g,t=>_.get({"-":"+",_:"/"},t)))),window.joiForm=(t=>{const e=t.object({course:t.string().trim().min(2).required(),department:t.string().trim().min(2).required(),email:t.string().trim().email({tlds:{allow:!1}}).regex(/@program\.com\.tw$/).required(),name:t.string().trim().min(2).required(),note:t.string().trim().empty("").default("").optional(),time:t.string().trim().min(2).required(),title:t.string().trim().min(2).required()}),i={abortEarly:!1,stripUnknown:!0};return t=>e.validateAsync(t,i)})(joi),window.sleep=e=>new Promise(t=>{setTimeout(t,e)}),window.httpBuildQuery=(t,e={})=>Qs.stringify(t,{arrayFormat:"brackets",...e}),window.vm=new Vue({el:"#app",data:{ready:!1,note:"",h:{department:"",email:"",name:"",title:"",registerd:[]}},computed:{course(){return this.paramBase64("course","")},time(){return this.paramBase64("time","")}},async mounted(){await loginPromise;try{var t=JSON5.parse(localStorage.getItem(location.pathname));t&&this.$set(this,"h",{...this.h,...t})}catch(t){}this.$watch("h",()=>{localStorage.setItem(location.pathname,JSON5.stringify(this.h))},{deep:!0}),this.note=this.paramBase64("note",""),this.ready=!0,await window.sleep(100);t=_.toArray(_.get(this,"h.registerd",[]));_.includes(t,this.course)&&await Swal.fire({icon:"warning",title:"已報名",text:"你可能已經報名過這個課程囉！"})},methods:{async btnSubmit(){try{this.showLoading("課程報名","處理中請稍候…");var t=await window.joiForm({course:this.course,department:this.h.department,email:this.h.email,name:this.h.name,note:this.note,time:this.time,title:this.h.title}),e=(await axios.post("https://cors-anywhere-ybtjbo45iq-uc.a.run.app",window.httpBuildQuery({"entry.1133765164":t.name,"entry.1150087531":t.course,"entry.1221220906":t.note,"entry.1360041841":t.time,"entry.548249594":t.title,"entry.661913675":t.email,"entry.66914760":t.department}),{params:{u:"https://docs.google.com/forms/d/e/1FAIpQLSdWRzEaZh6WHupjkq7vcVpjNKkVYpp44au8S95Wvb49d8rH4Q/formResponse"}}),_.toArray(_.get(this,"h.registerd",[])));this.$set(this.h,"registerd",_.take(_.uniq([t.course,...e]),5)),await Swal.fire({icon:"success",title:"報名成功"}),liff.closeWindow()}catch(t){console.error(t),Swal.fire({icon:"error",title:"報名失敗",text:t.message})}},async btnReset(t=!0){if(!t||(t=await Swal.fire({cancelButtonColor:"#3085d6",cancelButtonText:"保持原樣",confirmButtonColor:"#d33",confirmButtonText:"重設資料",focusCancel:!0,icon:"warning",showCancelButton:!0,text:"是否重設本頁面的資料？"})).value)return localStorage.removeItem(location.pathname),location.reload(),new Promise(t=>{})},showLoading(t,e){Swal.fire({title:t,text:e,allowOutsideClick:!1,showConfirmButton:!1,willOpen:()=>{Swal.showLoading()}})},paramBase64(t,e){try{var i=new URL(location).searchParams.get(t);return _.isNil(i)?e:window.decodeBase64(i)}catch(t){return e}}}});</script></body></html>