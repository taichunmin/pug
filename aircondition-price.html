<!doctype html><html><head><meta charset="UTF-8"><meta content="IE=edge" http-equiv="X-UA-Compatible"><meta content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,viewport-fit=cover,user-scalable=no" name="viewport"><title>搜尋冷氣資訊</title><script src="https://www.googletagmanager.com/gtag/js?id=UA-39556213-3" async></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-39556213-3");</script><link href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css" rel="stylesheet"><link href="https://cdn.jsdelivr.net/npm/font-awesome@4/css/font-awesome.min.css" rel="stylesheet"><link href="https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.min.css" rel="stylesheet"><link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700&display=swap" rel="stylesheet"><style>[v-cloak]{display:none}</style></head><body><div class="text-monospace container my-3" id="app" v-cloak><h2 class="mb-3 text-center">搜尋冷氣資訊</h2><div class="card mt-3"><h6 class="card-header"><i class="fa fa-search"></i> 總共 {{ machines.length }} 筆資料</h6><div class="card-body"><div class="input-group mb-2"><div class="input-group-prepend"><span class="input-group-text">顯示筆數</span></div><input class="form-control" id="h-keyword" inputmode="numeric" type="number" v-model.number="h.itemsPerPage"></div><div class="input-group"><div class="input-group-prepend"><span class="input-group-text">模糊搜尋</span></div><input class="form-control" id="h-keyword" placeholder="模糊搜尋: 型號、廠牌、註記" v-model="h.keyword"><div class="input-group-append"><button @click="h.keyword = ''" class="btn btn-outline-danger" type="button">清空</button></div></div></div><ul class="list-group list-group-flush"><li :key="m.id" class="d-flex flex-column list-group-item" v-for="m of _.take(sortedMachines, h.itemsPerPage)"><h4 class="badges mx-n1 my-0"><div class="badge mx-1 badge-warning">{{ m['配管'] }}</div><div class="badge mx-1 badge-info">{{ m['冷媒'] }}</div><div class="badge mx-1 badge-primary">{{ m['廠牌'] }}</div></h4><h3 class="text-monospace my-1">{{ m['型號'] }}</h3><div class="text-info">機身高寬深：{{ m['機身高寬深'] }}</div><div class="text-info">腳座寬深：{{ m['腳座寬深'] }}</div><small class="text-muted">註記：{{ m['註記'] }}</small></li></ul></div></div><script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/dayjs@1/dayjs.min.js" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/json5@2/dist/index.min.js" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/lodash@4/lodash.min.js" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/papaparse@5/papaparse.min.js" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/popper.js@1/dist/umd/popper.min.js" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1/components/prism-core.min.js" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1/plugins/autoloader/prism-autoloader.min.js" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/qs@6/dist/qs.min.js" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/sweetalert2@11" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/vue@2/dist/vue.min.js" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.min.js" crossorigin="anonymous"></script><script>window.countChar=(()=>{const e=_.toArray(" ()-./~、（）");return t=>_.omit(_.countBy(_.toLower(t)),e)})(),window.vm=new Vue({el:"#app",data:{machines:[],h:{keyword:"",itemsPerPage:25}},async mounted(){try{var t=JSON5.parse(localStorage.getItem(location.pathname));t&&this.$set(this,"h",{...this.h,...t})}catch(t){}this.$watch("h",()=>{localStorage.setItem(location.pathname,JSON5.stringify(this.h))},{deep:!0}),await this.init()},computed:{sortedMachines(){const e=_.toLower(_.trim(this.h.keyword));if(!e)return this.machines;const t=_.toPairs(window.countChar(e));return _.orderBy(this.machines,[e=>_.sumBy(t,t=>Math.min(_.toSafeInteger(e.countChar[t[0]]),t[1])),t=>this.lcs(e,t.fulltext)],["desc","desc"])}},methods:{async init(){try{this.showLoading("請稍候","讀取資料中"),await this.fetchMachines()}catch(t){t.message=_.get(t,"response.data.message",t.message),console.error(t),await Swal.fire({icon:"error",title:"發生錯誤",text:t.message}),location.reload()}finally{Swal.close()}},async getCsv(t,e=3e4){t=_.trim(_.get(await axios.get(t,{params:{cachebust:_.floor(Date.now()/e)}}),"data"));return _.get(Papa.parse(t,{encoding:"utf8",header:!0}),"data",[])},async fetchMachines(){var t=await this.getCsv("https://docs.google.com/spreadsheets/d/e/2PACX-1vSpasIcvTqLyX1gkaz-AAmRSQmDwXtUT6m8Sbn7RbsgykfDr5c32WmBwIc3nFqIAA/pub?gid=22307658&single=true&output=csv");const e=[];for(const[s,o]of _.toPairs(t)){var a=_.toLower(""+o["廠牌"]+o["型號"]+o["註記"]);e.push(_.fromPairs([..._.map(["型號","廠牌","機身高寬深","配管","腳座寬深","冷媒","註記"],t=>[t,_.trim(o[t]??"")]),["countChar",window.countChar(a)],["fulltext",a],["id",s]]))}this.$set(this,"machines",e)},lcs(a,s){if(!(_.isString(a)&&_.isString(s)&&a.length&&s.length))return 0;const t={};[a,s]=_.chain([" "+a," "+s]).orderBy(["length"],["desc"]).value(),t.len=s.length,t.lcs=_.times(2,()=>_.times(t.len,()=>0));for(let e=1;e<a.length;e++){const[o,i]=[t.lcs[1&e],t.lcs[1-(1&e)]];for(let t=1;t<s.length;t++)o[t]=a[e]===s[t]?i[t-1]+1:Math.max(i[t],o[t-1])}return t.lcs[1-(1&a.length)][t.len-1]},showLoading(t,e){Swal.fire({title:t,text:e,allowOutsideClick:!1,showConfirmButton:!1,willOpen:()=>{Swal.showLoading()}})}}});</script></body></html>